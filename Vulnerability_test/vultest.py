import math
print("Pratham Raj Sinha 21BIT0092")
n = int(input("Enter n: "))
sq = math.sqrt(n)
k = math.ceil(sq)
print("k = ",k)
ksq = k*k
if ksq > n:
    hsq = ksq-n
else:
    print("n is a perfect square. Try a different value next time.")
    raise SystemExit()

h = int(math.sqrt(hsq))
p = k-h
q = k+h
print("h = ",h)
print("p = ",p)
print("q = ",q)
e = int(input("Enter public key: "))
phi = (p-1)*(q-1)
print("Phi = ",phi)

#modulo inverse by formula
u = 1;
while (1+(u*phi))%e != 0:
    u+=1
print("u=",u)
d = math.floor((1+(u*phi)/e))

print("Extracted private key= ",d)


